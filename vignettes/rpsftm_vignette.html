<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Simon Bond, Annabel Allison" />

<meta name="date" content="2016-06-25" />

<title>rpsftm: rank-preserving structural failure time models for survival data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">rpsftm: rank-preserving structural failure time models for survival data</h1>
<h4 class="author"><em>Simon Bond, Annabel Allison</em></h4>
<h4 class="date"><em>2016-06-25</em></h4>
</div>


<div id="summary" class="section level2">
<h2>Summary</h2>
<p>The package <code>rpsftm</code> provides functions to fit a rank preserving structural failure time model to a two-arm clinical trial with survival outcomes.</p>
</div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The rank preserving structural failure time model (RPSFTM) is a method used to adjust for treatment switching in trials with survival outcomes. Treatment switching occurs when patients switch from their randomised arm to the other treatment during the study. The RPSFTM is due to <em>Robins and Tsiatis (1991)</em> and has been developed by <em>White et al. (1997, 1999)</em> and <em>Bowden et al. (2015)</em>.</p>
</div>
<div id="methods" class="section level2">
<h2>Methods</h2>
<div id="rpsftm-assumptions" class="section level3">
<h3>RPSFTM assumptions</h3>
<p>Let <span class="math">\(T_i = T_i^{off} + T_i^{on}\)</span> be the observed event time for subject <span class="math">\(i\)</span>, where <span class="math">\(T_i^{off}\)</span> and <span class="math">\(T_i^{on}\)</span> are the time that the patient spent off and on treatment, respectively. The <span class="math">\(T_i\)</span> are related to the counter-factual or treatment-free event times <span class="math">\(U_i\)</span> by the causal model <span class="math">\[
U_i = T_i^{off} + T_i^{on}\exp(\psi_0)
\]</span> where <span class="math">\(\exp(-\psi_0)\)</span> is the acceleration factor associated with treatment and <span class="math">\(\psi_0\)</span> is the true causal parameter.</p>
<p>To estimate <span class="math">\(\psi\)</span> we assume that the <span class="math">\(U_i\)</span> are independent of randomised treatment group <span class="math">\(R\)</span>, i.e. if the groups are similar with respect to all other characteristics except treatment, the average event times should be the same in each group if no individual were treated. A g-estimation procedure is used to find the value of <span class="math">\(\psi\)</span> such that <span class="math">\(U\)</span> is independent of <span class="math">\(R\)</span>. For each value of <span class="math">\(\psi\)</span> considered, the hypothesis <span class="math">\(\psi_0 = \psi\)</span> is tested by computing <span class="math">\(U_i(\psi)\)</span> and calculating <span class="math">\(Z(\psi)\)</span> as the test statistic. This is usually the same test statistic as for the intention-to-treat analysis. In the <code>rpsftm</code> function, the test options are log rank (default), Cox, and Weibull. For the parametric Weibull test, the point estimate (<span class="math">\(\hat{\psi}\)</span>) is the value of <span class="math">\(\psi\)</span> for which <span class="math">\(Z(\psi) = 0\)</span>. For the non-parametric tests (log rank, Cox), <span class="math">\(\hat{\psi}\)</span> is the value of <span class="math">\(\psi\)</span> for which <span class="math">\(Z(\psi)\)</span> crosses 0, since <span class="math">\(Z(\psi)\)</span> is a step function. Confidence intervals are similarly found with the <span class="math">\(100(1-\alpha)\%\)</span> confidence interval being the set <span class="math">\(\{\psi: |Z(\psi)| &lt; z_{1-\alpha/2}\}\)</span>, where <span class="math">\(z_{1-\alpha/2}\)</span> is the <span class="math">\(1-\alpha/2\)</span> percentile of the standard normal distribution.</p>
<p>As well as assuming that the only difference between randomised groups is the treatment received, the RPSFTM also assumes a `common treatment effect’. The common treatment effect assumption states that the treatment effect is the same for all individuals (with respect to time spent on treatment) regardless of when treatment is received.</p>
</div>
<div id="recensoring" class="section level3">
<h3>Recensoring</h3>
<p>The censoring indicators of the observed event times are initially carried over to the counter-factual event times. However, the uninformative censoring on the <span class="math">\(T_i\)</span> scale may be informative on the <span class="math">\(U_i\)</span> scale. Suppose we have two individuals with the same <span class="math">\(U_i\)</span>, one of whom receives the superior treatment. The individual receiving the superior treatment has their <span class="math">\(U_i\)</span> extended so that they are censored whilst the other individual may observe the event. Therefore, on the <span class="math">\(U_i\)</span> scale, censoring is informative with respect to treatment group. To overcome this problem, the counter-factual event times are recensored by the minimum <span class="math">\(U_i\)</span> that could have been observed for each individual across their possible treatment changes.</p>
<p>Let <span class="math">\(C_i\)</span> be the potential censoring time for an individual <span class="math">\(i\)</span>. An individual is then recensored at the minimum possible censoring time: <span class="math">\[
D_i^*(\psi) = min(C_i, C_i\exp(\psi)). 
\]</span> If <span class="math">\(D_i^*(\psi) &lt; U_i\)</span>, then <span class="math">\(U_i\)</span> is replaced by <span class="math">\(D_i^*\)</span> and the censoring indicator is replaced by 0. For treatment arms where switching does not occur, there can be no informative censoring and so recensoring is not applied.</p>
</div>
</div>
<div id="sensitivity-analysis" class="section level2">
<h2>Sensitivity analysis</h2>
<p>As previously mentioned, the RPSFTM has two assumptions:</p>
<ol style="list-style-type: decimal">
<li>The only difference between randomised groups is the treatment received.</li>
<li>The treatment effect is the same for all individuals regardless of when treatment is received.</li>
</ol>
<p>Whilst the first assumption is plausible in a randomised controlled trial, the latter may be unlikely to hold if, for example, control group patients can only switch at disease progression then the treatment benefit may be less in these individuals compared to those randomised to the experimental treatment. The <code>rpsftm</code> function allows for investigation of deviations from the common treatment effect assumption by featuring a treatment effect modifier variable which means the treatment effect can be varied across individuals. This is achieved by multiplying <span class="math">\(\psi_0\)</span> by some factor <span class="math">\(k_i \in [0, 1]\)</span>: <span class="math">\[
U_i = T_i^{off} + T_i^{on}\exp(k_i\psi_0).
\]</span> For example, we can investigate what would happen to the estimate of <span class="math">\(\psi\)</span> if the treatment effect in switchers was half of that in the experimental group by setting <span class="math">\(k_i = 1\)</span> for patients in the experimental group and <span class="math">\(k_i = 0.5\)</span> for patients in the control group.</p>
<p>Recensoring is undertaken in a similar way by recensoring at the minimum possible censoring time: <span class="math">\[
D_i^*(\psi) = min(C_i, C_i\exp(k_i\psi)).
\]</span> Again, if <span class="math">\(D_i^*(\psi) &lt; U_i\)</span>, then <span class="math">\(U_i\)</span> is replaced by <span class="math">\(D_i^*\)</span> and the censoring indicator is replaced by 0.</p>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<p>The <code>rpsftm</code> function will be illustrated using a simulated dataset <code>immdef</code> based on a randomized controlled trial; see <em>Concorde Coordinating Committee (1994)</em>. The trial compares two policies (immediate or deferred treatment) of zidovudine treatment in symptom free individuals infected with HIV. The immediate treatment arm received treatment at randomisation whilst the deferred arm received treatment either at onset of AIDS related complex or AIDs or development of persistently low CD4 count. The primary endpoint was time to progression to AIDS or CDC group IV disease, or death.</p>
<div id="data" class="section level3">
<h3>Data</h3>
<p>The <code>immdef</code> data frame has 1000 observations and 8 variables:</p>
<ul>
<li><strong>id</strong> participant ID number</li>
<li><strong>def</strong> indicator that the participant was assigned to the Deferred treatment arm</li>
<li><strong>imm</strong> indicator that the participant was assigned to the Immediate treatment arm</li>
<li><strong>censyrs</strong> a real, or theoretical censoring time, corresponding to the close of study minus the time of entry for each participant</li>
<li><strong>xo</strong> an indicator that crossover occurred</li>
<li><strong>xoyrs</strong> the time at which crossover happened, or 0 for participants in the Immediate arm</li>
<li><strong>prog</strong> an indicator of disease progression (1), or censoring (0)</li>
<li><strong>entry</strong> the time of entry into the study</li>
</ul>
<p>The first six entries are:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rpsftm)
<span class="kw">head</span>(immdef)
<span class="co">#&gt;   id def imm censyrs xo    xoyrs prog  progyrs entry</span>
<span class="co">#&gt; 1  1   0   1       3  0 0.000000    0 3.000000     0</span>
<span class="co">#&gt; 2  2   1   0       3  1 2.652797    0 3.000000     0</span>
<span class="co">#&gt; 3  3   0   1       3  0 0.000000    1 1.737838     0</span>
<span class="co">#&gt; 4  4   0   1       3  0 0.000000    1 2.166291     0</span>
<span class="co">#&gt; 5  5   1   0       3  1 2.122100    1 2.884646     0</span>
<span class="co">#&gt; 6  6   1   0       3  1 0.557392    0 3.000000     0</span></code></pre>
<p>For example, subject 2 was randomised to the deferred arm, started treatment at 2.65 years and was censored at 3 years (the end of the study). Subject 3 was randomised to the immediate treatment arm and progressed (observed the event) at 1.74 years. Subject 5 was randomised to the deferred treatment arm, started treatment at 2.12 years and progressed at 2.88 years. The trial lasted 3 years with staggered entry over the first 1.5 years. The variable <strong>censyrs</strong> gives the time from entry to the end of the trial. The table below shows summary statistics for the <code>immdef</code> data:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tableone)
vars       &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;def&quot;</span>, <span class="st">&quot;imm&quot;</span>, <span class="st">&quot;censyrs&quot;</span>, <span class="st">&quot;xo&quot;</span>, <span class="st">&quot;xoyrs&quot;</span>, <span class="st">&quot;prog&quot;</span>, <span class="st">&quot;progyrs&quot;</span>, <span class="st">&quot;entry&quot;</span>)
factorVars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;def&quot;</span>, <span class="st">&quot;imm&quot;</span>, <span class="st">&quot;xo&quot;</span>, <span class="st">&quot;prog&quot;</span>) 
<span class="kw">CreateTableOne</span>(<span class="dt">vars=</span>vars, <span class="dt">data=</span>immdef, <span class="dt">factorVars=</span>factorVars, <span class="dt">includeNA=</span><span class="ot">FALSE</span>, <span class="dt">test=</span><span class="ot">FALSE</span>)
<span class="co">#&gt;                      </span>
<span class="co">#&gt;                       Overall     </span>
<span class="co">#&gt;   n                   1000        </span>
<span class="co">#&gt;   def = 1 (%)          500 (50.0) </span>
<span class="co">#&gt;   imm = 1 (%)          500 (50.0) </span>
<span class="co">#&gt;   censyrs (mean (sd)) 2.25 (0.45) </span>
<span class="co">#&gt;   xo = 1 (%)           189 (18.9) </span>
<span class="co">#&gt;   xoyrs (mean (sd))   0.78 (0.93) </span>
<span class="co">#&gt;   prog = 1 (%)         312 (31.2) </span>
<span class="co">#&gt;   progyrs (mean (sd)) 1.93 (0.66) </span>
<span class="co">#&gt;   entry (mean (sd))   0.75 (0.45)</span></code></pre>
</div>
</div>
<div id="fitting-the-rpsftm" class="section level2">
<h2>Fitting the RPSFTM</h2>
<p>The main function used in model fitting is <code>rpsftm</code> which takes the arguments:</p>
<ul>
<li><strong>formula</strong> a formula with a minimal structure of <code>ReCen(time, censor_time)~Instr(arm, rx)</code> where
<ul>
<li><code>time</code> is the observed event time,</li>
<li><code>censor_time</code> is the real or theoretical censoring time,</li>
<li><code>arm</code> is the randomised treatment arm, and</li>
<li><code>rx</code> is the proportion of time spent on treatment, taking values in [0, 1].</li>
</ul>
Further terms can be added to the right hand side to adjust for covariates.</li>
<li><strong>data</strong> an optional data frame containing the variables.</li>
<li><strong>subset</strong> an expression indicating which subset of the rows of data should be used in the fit. This can be a logical vector, a numeric vector indicating which observation numbers are to be included, or a character vector of row names to be included. All observations are included by default.</li>
<li><strong>na.action</strong> a missing-data filter function. This is applied to the <code>model.frame</code> after any subset argument has been used. Default is <code>options()$na.action</code>.</li>
<li><strong>test</strong> one of <code>survdiff</code>, <code>coxph</code> or <code>survreg</code>. Describes the test to be used in the estimating equation. Default is <code>survdiff</code>.</li>
<li><strong>low_psi</strong> the lower limit of the range to search for the causal parameter. Default is -1.</li>
<li><strong>hi_psi</strong> the upper limit of the range to search for the causal parameter. Default is 1.</li>
<li><strong>alpha</strong> the significance level used to calculate the confidence intervals. Default is 0.05.</li>
<li><strong>treat_modifier</strong> an optional parameter that <span class="math">\(\psi\)</span> is multiplied by on an individual observation level to give differing impact to treatment. The values are transformed by <code>abs(.)/max(abs(.))</code> to ensure 1 is the largest weight. Default is 1.</li>
<li><strong>recensor</strong> a logical to perform recensoring if set to TRUE. Default is TRUE.</li>
<li><strong>outoswitch</strong> a logical to autodetect cases of no switching. Default is TRUE.</li>
</ul>
<p>The <code>rpsftm</code> function first evaluates <span class="math">\(Z(\psi)\)</span> at <span class="math">\(\psi\)</span> = <code>low_psi</code> and <code>hi_psi</code>. If they have the same sign, the procedure is stopped and the following error message is produced</p>
<pre><code>#&gt; Error in rpsftm(formula = ReCen(progyrs, censyrs) ~ Instr(imm, rx), data = immdef, : 
#&gt; The starting interval (1, 2) to search for a solution for psi
#&gt; gives values of the same sign (-8.95, -12.3).
#&gt; Try a wider interval?</code></pre>
<p>This suggests widening the search interval via trial and error until the values of <span class="math">\(Z(\psi)\)</span> at <code>lowpsi</code> and <code>hipsi</code> are of opposite sign. Otherwise, <code>rpsftm</code> next uses <code>uniroot</code> to search the interval for <span class="math">\(\hat{\psi}\)</span> and the <span class="math">\(100(1-\alpha)\%\)</span> confidence interval by using the target values 0, <span class="math">\(z_{1-\alpha/2}\)</span> and <span class="math">\(z_{\alpha/2}\)</span>. If the function fails to find <span class="math">\(\hat{\psi}\)</span> or either limit of the confidence interval, it will set the value to NA and produce a warning message, for example,</p>
<pre><code>#&gt; Warning in rpsftm(formula = ReCen(progyrs, censyrs) ~ Instr(imm, rx), data
#&gt; = immdef, : Evaluation of a limit of the Confidence Interval failed. It is
#&gt; set to NA</code></pre>
<p>Investigation of a plot of <span class="math">\(Z(\psi)\)</span> against <span class="math">\(\psi\)</span> (example shown below) for a range of values of <span class="math">\(\psi\)</span> could show why the functions fails to find a root. In this case, the search interval used in <code>rpsftm</code> was not be wide enough to find the upper confidence limit.</p>
<!--
![Plot of $z(\psi)$ against ($\psi$) for $\psi \in [-1, 0]$.](zpsiplot.png)
-->
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Recensoring is performed by default unless <code>recensor=FALSE</code> is specified in the function parameters. After finding <span class="math">\(\hat{\psi}\)</span>, <code>rpsftm</code> refits the model at <span class="math">\(\hat{\psi}\)</span> and produces a <code>survdiff</code> object of the counter-factual event times to be used in plotting Kaplan-Meier curves. The function returns</p>
<ul>
<li><strong>psi</strong> the estimated parameter</li>
<li><strong>fit</strong> a <code>survdiff</code> object to produce Kaplan-Meier curves of the estimated counter-factual event times in each treatment arm using <code>plot()</code></li>
<li><strong>formula</strong> a formula representing any adjustments, strata or clusters used</li>
<li><strong>regression</strong> the survival regression object at <strong>psi</strong></li>
<li><strong>Sstar</strong> the (possibly) recensored <code>Surv()</code> data using <strong>psi</strong></li>
<li><strong>ans</strong> the object returned from <code>uniroot</code> used to solve the estimating equation</li>
<li><strong>CI</strong> a vector of the confidence interval around <strong>psi</strong></li>
<li><strong>call</strong> the R call object</li>
</ul>
<!--In order to fit the `rpsftm` with the example data, a variable __rx__ for the proportion of time spent on treatment was first created. -->
<p>We now show how to use <code>rpsftm</code> with the <code>immdef</code> data. First, a variable <strong>rx</strong> for the proportion of time spent on treatment must be created:</p>
<pre class="sourceCode r"><code class="sourceCode r">rx &lt;-<span class="st"> </span><span class="kw">with</span>(immdef, 
           <span class="kw">ifelse</span>(imm ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>xo ==<span class="st"> </span><span class="dv">0</span>,
                  <span class="dv">1</span>,
                  <span class="kw">ifelse</span>(imm ==<span class="st"> </span><span class="dv">1</span> &amp;<span class="st"> </span>xo ==<span class="st"> </span><span class="dv">1</span>,
                         xoyrs/progyrs,
                         <span class="kw">ifelse</span>(imm ==<span class="st"> </span><span class="dv">0</span> &amp;<span class="st"> </span>xo ==<span class="st"> </span><span class="dv">1</span>,
                                (progyrs-xoyrs)/progyrs,
                                <span class="dv">0</span>))))</code></pre>
<p>This sets <strong>rx</strong> to 1 in the immediate treatment arm (since no patients could switch to the deferred arm), 0 in the deferred arm patients that did not receive treatment and <strong>(progyrs - xoyrs)/progyrs</strong> in the deferred arm patients that did receive treatment. Using the default options, the fitted model is</p>
<pre class="sourceCode r"><code class="sourceCode r">rpsftm_fit_lr &lt;-<span class="st"> </span><span class="kw">rpsftm</span>(<span class="dt">formula=</span><span class="kw">ReCen</span>(progyrs, censyrs) ~<span class="st"> </span><span class="kw">Instr</span>(imm, rx), 
                        <span class="dt">data=</span>immdef)</code></pre>
<p>The above formula fits a RPSFTM where <code>progyrs</code> is the observed event time, <code>censyrs</code> is the real or theoretical censoring time, <code>imm</code> is the randomised group indicator and <code>rx</code> is the proportion of time spent on treatment. The log rank test is used in finding the point estimate of <span class="math">\(\psi\)</span>. The point estimate and 95% confidence interval can be returned using <code>rpsftm_fit_lr$psi</code> and <code>rpsftm_fit_lr$CI</code> which gives <span class="math">\(\hat{\psi} = -0.181\)</span> (-0.35, 0.00199). The function <code>plot()</code> produces Kaplan-Meier curves of the counter-factual event times in each group and can be used to check that the distributions are indeed the same at <span class="math">\(\hat{\psi}\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(rpsftm_fit_lr)</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<!-- COXPH-->
<p>To use the Wald test from a Cox regression model in place of the log rank test, we specify <code>test=coxph</code> in the function parameters. Covariates can also be included in the estimation procedure by adding them to the right hand side of the formula. For example, baseline covariates that are included in the intention-to-treat analysis may also be incorporated into the estimation procedure of the RPSFTM. In the following example we add entry time as a covariate and use <code>summary()</code> to find the value of <span class="math">\(\hat{\psi}\)</span> and its 95% confidence interval:</p>
<pre class="sourceCode r"><code class="sourceCode r">rpsftm_fit_cph &lt;-<span class="st"> </span><span class="kw">rpsftm</span>(<span class="dt">formula=</span><span class="kw">ReCen</span>(progyrs, censyrs) ~<span class="st"> </span><span class="kw">Instr</span>(imm, rx) +<span class="st"> </span>entry, 
                         <span class="dt">data=</span>immdef,
                         <span class="dt">test=</span>coxph)
<span class="kw">summary</span>(rpsftm_fit_cph)
<span class="co">#&gt; rpsftm(formula = ReCen(progyrs, censyrs) ~ Instr(imm, rx) + entry, </span>
<span class="co">#&gt;     data = immdef, test = coxph)</span>
<span class="co">#&gt;   n= 1000, number of events= 286 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;            coef exp(coef)  se(coef)      z Pr(&gt;|z|)</span>
<span class="co">#&gt; arm   -0.002135  0.997867  0.118300 -0.018    0.986</span>
<span class="co">#&gt; entry  0.123541  1.131496  0.148719  0.831    0.406</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;       exp(coef) exp(-coef) lower .95 upper .95</span>
<span class="co">#&gt; arm      0.9979     1.0021    0.7914     1.258</span>
<span class="co">#&gt; entry    1.1315     0.8838    0.8454     1.514</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Concordance= 0.514  (se = 0.018 )</span>
<span class="co">#&gt; Rsquare= 0.001   (max possible= 0.976 )</span>
<span class="co">#&gt; Likelihood ratio test= 0.69  on 2 df,   p=0.7075</span>
<span class="co">#&gt; Wald test            = 0.69  on 2 df,   p=0.7079</span>
<span class="co">#&gt; Score (logrank) test = 0.69  on 2 df,   p=0.7077</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; psi: -0.1811515</span>
<span class="co">#&gt; exp(psi): 0.834309</span>
<span class="co">#&gt; Confidence Interval, psi -0.3497117 0.00330558</span>
<span class="co">#&gt; Confidence Interval, exp(psi)  0.7048913 1.003311</span></code></pre>
<p>From the output we get <span class="math">\(\hat{\psi} = -0.181\)</span> (-0.35, 0.00331). Again, we can plot the Kaplan-Meier curves of the counter-factual event times in each group:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(rpsftm_fit_cph)</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<!--SURVREG-->
<p>Similary, for the Weibull model we have:</p>
<pre class="sourceCode r"><code class="sourceCode r">rpsftm_fit_wb &lt;-<span class="st"> </span><span class="kw">rpsftm</span>(<span class="dt">formula=</span><span class="kw">ReCen</span>(progyrs, censyrs) ~<span class="st"> </span><span class="kw">Instr</span>(imm, rx) +<span class="st"> </span>entry, 
                        <span class="dt">data=</span>immdef,
                        <span class="dt">test=</span>survreg)
<span class="kw">summary</span>(rpsftm_fit_wb)
<span class="co">#&gt; rpsftm(formula = ReCen(progyrs, censyrs) ~ Instr(imm, rx) + entry, </span>
<span class="co">#&gt;     data = immdef, test = survreg)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt;                 Value Std. Error       z        p</span>
<span class="co">#&gt; (Intercept)  1.388057     0.0857 16.1963 5.35e-59</span>
<span class="co">#&gt; arm         -0.000461     0.0780 -0.0059 9.95e-01</span>
<span class="co">#&gt; entry       -0.058172     0.0906 -0.6419 5.21e-01</span>
<span class="co">#&gt; Log(scale)  -0.417603     0.0568 -7.3495 1.99e-13</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Scale= 0.659 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Weibull distribution</span>
<span class="co">#&gt; Loglik(model)= -759.7   Loglik(intercept only)= -760</span>
<span class="co">#&gt;  Chisq= 0.4 on 2 degrees of freedom, p= 0.82 </span>
<span class="co">#&gt; Number of Newton-Raphson Iterations: 6 </span>
<span class="co">#&gt; n= 1000 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; psi: -0.181231</span>
<span class="co">#&gt; exp(psi): 0.8342427</span>
<span class="co">#&gt; Confidence Interval, psi -0.3501386 0.005173062</span>
<span class="co">#&gt; Confidence Interval, exp(psi)  0.7045904 1.005186</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(rpsftm_fit_wb)</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The output shows that <span class="math">\(\hat{\psi} = -0.181\)</span> (-0.35, 0.00517). In all three cases, the point estimate and 95% confidence interval of <span class="math">\(\psi\)</span> are similar.</p>
</div>
<div id="limitations" class="section level2">
<h2>Limitations</h2>
<p>There are a few cases where we may encounter problems with root finding:</p>
<ol style="list-style-type: decimal">
<li>The interval (<code>lowpsi</code>, <code>hipsi</code>) may not be wide enough to find one or both of the confidence limits. This can be easily be rectified by extending the range.</li>
<li>No confidence limits may exist (i.e. they tail off to <span class="math">\(\pm \infty\)</span>). In this case they should be reported as <span class="math">\(\pm \infty\)</span>.</li>
<li>There may be multiple solutions to <span class="math">\(Z(\psi)=0\)</span> within the interval (<code>lowpsi</code>, <code>hipsi</code>). <code>uniroot</code> will return one value even if this is the case.</li>
</ol>
<p>For all of the above a graph of <span class="math">\(Z(\psi)\)</span> against <span class="math">\(\psi\)</span> would highlight the issue. Another possibility is for the <code>coxph</code> function to fail to converge. This occurs when the maximum likelihood estimate of a coefficient is infinity, e.g. if one of the treatment groups has no events. The <code>coxph</code> documentation states that the Wald statistic should be ignored in this case and therefore the <code>rpsftm</code> output should be taken with caution.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Bowden, J., Seamen, S., Huang, X. and White, I.R. (2015). Gaining power and precision by using model-based weights in the analysis of late stage cancer trials with substantial treatment switching. <em>Statistics in Medicine</em> 35: 1423-1440.</p>
<p>Concorde Coordinating Committee. (1994). Concorde: MRC/ANRS randomised double-blind controlled trial of immediate and deferred zidovudine in symptom-free HIV infection. <em>Lancet</em> 343: 871-881.</p>
<p>Robins, J.M. and Tsiatis, A.A. (1991). Correcting for non-compliance in randomized trials using rank preserving structural failure time models. <em>Communications in Statistics Theory and Methods</em> 20:2609-2631.</p>
<p>White, I.R., Babiker, A.G., Walker, S. and Darbyshire, J.H. (1999). Randomisation-based methods for correcting for treatment changes: examples from the Concorde trial. <em>Statistics in Medicine</em> 18: 2617-2634.</p>
<p>White, I.R., Walker, S., Babiker, A.G. and Darbyshire, J.H. (1997). Impact of treatment changes on the interpretation of the Concorde trial. <em>AIDS</em> 11: 999-1006.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
